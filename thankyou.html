<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Merci pour votre achat !</title>

  <!-- âœ… Script DataFast (utile pour tracking global) -->
  <script
    defer
    data-website-id="683f535ef1a0753281970df8"
    data-domain="toolmonsters-lab.com"
    src="https://datafa.st/js/script.js">
  </script>

  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 4rem;
      background: #fff;
    }
  </style>
</head>
<body>
  <h1>âœ… Merci pour votre achat !</h1>
  <p>Votre commande a bien Ã©tÃ© enregistrÃ©e.</p>

  <script>
    // RÃ©cupÃ©ration des paramÃ¨tres depuis l'URL
    const params = new URLSearchParams(window.location.search);
    const email = params.get("email");
    const visitorId = params.get("datafast_visitor_id");
    const sessionId = params.get("datafast_session_id");
    const stripeId = params.get("stripe_payment_id");

    // âœ… Token API DataFast sÃ©curisÃ© (copiÃ© depuis ton compte)
    const DATAFAST_API_KEY = "df_c436ae46e304995e97ad938e5d095ecbfef92888fbd99d98";

    // âœ… Payload envoyÃ© Ã  lâ€™API DataFast
    const payload = {
      website_id: "683f535ef1a0753281970df8",
      event_name: "payment",
      email,
      stripe_payment_id: stripeId,
      datafast_visitor_id: visitorId,
      datafast_session_id: sessionId,
      referrer: "https://toolmonsters-lab.com"
    };

    // ğŸ” Appel API DataFast pour forcer lâ€™attribution
    fetch("https://datafa.st/api/event", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${DATAFAST_API_KEY}`
      },
      body: JSON.stringify(payload)
    })
    .then(res => {
      console.log("ğŸ¯ Conversion envoyÃ©e Ã  DataFast :", res.status);
    })
    .catch(err => {
      console.error("âŒ Erreur lors de lâ€™envoi Ã  DataFast :", err);
    });
  </script>
</body>
</html>
